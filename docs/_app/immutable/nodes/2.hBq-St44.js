var kt=Object.defineProperty;var It=Object.getPrototypeOf;var At=Reflect.get;var Fe=t=>{throw TypeError(t)};var Et=(t,e,r)=>e in t?kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ve=(t,e,r)=>Et(t,typeof e!="symbol"?e+"":e,r),qe=(t,e,r)=>e.has(t)||Fe("Cannot "+r);var D=(t,e,r)=>(qe(t,e,"read from private field"),r?r.call(t):e.get(t)),oe=(t,e,r)=>e.has(t)?Fe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r);var be=(t,e,r)=>(qe(t,e,"access private method"),r);var Ye=(t,e,r)=>At(It(t),r,e);import{t as T,a as S,c as St,n as Be,d as Z}from"../chunks/0nL5vWoZ.js";import"../chunks/cITaCZdO.js";import{a2 as Dt,B as Se,h as B,a4 as Mt,ad as Ct,y as $t,b as Rt,k as b,J as Tt,z as Nt,A as Ke,C as fe,c as le,a7 as Lt,D as nt,a as at,F as Bt,ab as st,a1 as Pt,O as Ut,an as j,ao as De,$ as Je,ap as Wt,aq as Ot,ar as Gt,aa as Ht,as as zt,d as Xt,at as jt,au as Ft,a5 as Vt,av as qt,aw as Yt,ax as Kt,ay as Jt,N as R,az as Zt,t as N,v as m,w,x as E,n as it,i as te,q,am as V,s as Y,aA as he,ak as z,M as _e}from"../chunks/B3Rm3xD6.js";import{i as K,r as Pe,p as Te,s as Qt,_ as er}from"../chunks/CQLMhFUI.js";import{i as tr,c as rr,d as ae,n as nr,a as ar,s as O}from"../chunks/DDzDgEqh.js";import{s as Ue}from"../chunks/BYJWQR9v.js";import{o as Ie}from"../chunks/ymPpswPE.js";function sr(t,e){if(e){const r=document.body;t.autofocus=!0,Dt(()=>{document.activeElement===r&&t.focus()})}}function ir(t,e){return e}function or(t,e,r,n){for(var a=[],s=e.length,o=0;o<s;o++)Gt(e[o].e,a,!0);var p=s>0&&a.length===0&&r!==null;if(p){var g=r.parentNode;Ht(g),g.append(r),n.clear(),F(t,e[0].prev,e[s-1].next)}zt(a,()=>{for(var u=0;u<s;u++){var d=e[u];p||(n.delete(d.k),F(t,d.prev,d.next)),Xt(d.e,!p)}})}function lr(t,e,r,n,a,s=null){var o=t,p={flags:e,items:new Map,first:null};{var g=t;o=B?Se(Mt(g)):g.appendChild(Ct())}B&&$t();var u=null,d=!1,c=Tt(()=>{var l=r();return Pt(l)?l:l==null?[]:st(l)});Rt(()=>{var l=b(c),i=l.length;if(d&&i===0)return;d=i===0;let f=!1;if(B){var y=o.data===Nt;y!==(i===0)&&(o=Ke(),Se(o),fe(!1),f=!0)}if(B){for(var v=null,h,I=0;I<i;I++){if(le.nodeType===8&&le.data===Lt){o=le,f=!0,fe(!1);break}var _=l[I],x=n(_,I);h=ot(le,p,v,null,_,x,I,a,e,r),p.items.set(x,h),v=h}i>0&&Se(Ke())}B||cr(l,p,o,a,e,n,r),s!==null&&(i===0?u?nt(u):u=at(()=>s(o)):u!==null&&Bt(u,()=>{u=null})),f&&fe(!0),b(c)}),B&&(o=le)}function cr(t,e,r,n,a,s,o){var p=t.length,g=e.items,u=e.first,d=u,c,l=null,i=[],f=[],y,v,h,I;for(I=0;I<p;I+=1){if(y=t[I],v=s(y,I),h=g.get(v),h===void 0){var _=d?d.e.nodes_start:r;l=ot(_,e,l,l===null?e.first:l.next,y,v,I,n,a,o),g.set(v,l),i=[],f=[],d=l.next;continue}if(ur(h,y,I),(h.e.f&De)!==0&&nt(h.e),h!==d){if(c!==void 0&&c.has(h)){if(i.length<f.length){var x=f[0],k;l=x.prev;var M=i[0],A=i[i.length-1];for(k=0;k<i.length;k+=1)Ze(i[k],x,r);for(k=0;k<f.length;k+=1)c.delete(f[k]);F(e,M.prev,A.next),F(e,l,M),F(e,A,x),d=x,l=A,I-=1,i=[],f=[]}else c.delete(h),Ze(h,d,r),F(e,h.prev,h.next),F(e,h,l===null?e.first:l.next),F(e,l,h),l=h;continue}for(i=[],f=[];d!==null&&d.k!==v;)(d.e.f&De)===0&&(c??(c=new Set)).add(d),f.push(d),d=d.next;if(d===null)continue;h=d}i.push(h),l=h,d=h.next}if(d!==null||c!==void 0){for(var $=c===void 0?[]:st(c);d!==null;)(d.e.f&De)===0&&$.push(d),d=d.next;var L=$.length;if(L>0){var X=p===0?r:null;or(e,$,X,g)}}Je.first=e.first&&e.first.e,Je.last=l&&l.e}function ur(t,e,r,n){Ot(t.v,e),t.i=r}function ot(t,e,r,n,a,s,o,p,g,u){var d=(g&jt)!==0,c=(g&Ft)===0,l=d?c?Ut(a):j(a):a,i=(g&Wt)===0?o:j(o),f={i,v:l,k:s,a:null,e:null,prev:r,next:n};try{return f.e=at(()=>p(t,l,i,u),B),f.e.prev=r&&r.e,f.e.next=n&&n.e,r===null?e.first=f:(r.next=f,r.e.next=f.e),n!==null&&(n.prev=f,n.e.prev=f.e),f}finally{}}function Ze(t,e,r){for(var n=t.next?t.next.e.nodes_start:r,a=e?e.e.nodes_start:r,s=t.e.nodes_start;s!==n;){var o=Vt(s);a.before(s),s=o}}function F(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function lt(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=lt(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function dr(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=lt(t))&&(n&&(n+=" "),n+=e);return n}function ct(t){return typeof t=="object"?dr(t):t??""}const Qe=[...` 	
\r\fÂ \v\uFEFF`];function fr(t,e,r){var n=t==null?"":""+t;if(e&&(n=n?n+" "+e:e),r){for(var a in r)if(r[a])n=n?n+" "+a:a;else if(n.length)for(var s=a.length,o=0;(o=n.indexOf(a,o))>=0;){var p=o+s;(o===0||Qe.includes(n[o-1]))&&(p===n.length||Qe.includes(n[p]))?n=(o===0?"":n.substring(0,o))+n.substring(p+1):o=p}}return n===""?null:n}function et(t,e=!1){var r=e?" !important;":";",n="";for(var a in t){var s=t[a];s!=null&&s!==""&&(n+=" "+a+": "+s+r)}return n}function Me(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function vr(t,e){if(e){var r="",n,a;if(Array.isArray(e)?(n=e[0],a=e[1]):n=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,o=0,p=!1,g=[];n&&g.push(...Object.keys(n).map(Me)),a&&g.push(...Object.keys(a).map(Me));var u=0,d=-1;const y=t.length;for(var c=0;c<y;c++){var l=t[c];if(p?l==="/"&&t[c-1]==="*"&&(p=!1):s?s===l&&(s=!1):l==="/"&&t[c+1]==="*"?p=!0:l==='"'||l==="'"?s=l:l==="("?o++:l===")"&&o--,!p&&s===!1&&o===0){if(l===":"&&d===-1)d=c;else if(l===";"||c===y-1){if(d!==-1){var i=Me(t.substring(u,d).trim());if(!g.includes(i)){l!==";"&&c++;var f=t.substring(u,c).trim();r+=" "+f+";"}}u=c+1,d=-1}}}}return n&&(r+=et(n)),a&&(r+=et(a,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function ge(t,e,r,n,a,s){var o=t.__className;if(B||o!==r){var p=fr(r,n,s);(!B||p!==t.getAttribute("class"))&&(p==null?t.removeAttribute("class"):e?t.className=p:t.setAttribute("class",p)),t.__className=r}else if(s&&a!==s)for(var g in s){var u=!!s[g];(a==null||u!==!!a[g])&&t.classList.toggle(g,u)}return s}function Ce(t,e={},r,n){for(var a in r){var s=r[a];e[a]!==s&&(r[a]==null?t.style.removeProperty(a):t.style.setProperty(a,s,n))}}function hr(t,e,r,n){var a=t.__style;if(B||a!==e){var s=vr(e,n);(!B||s!==t.getAttribute("style"))&&(s==null?t.removeAttribute("style"):t.style.cssText=s),t.__style=e}else n&&(Array.isArray(n)?(Ce(t,r==null?void 0:r[0],n[0]),Ce(t,r==null?void 0:r[1],n[1],"important")):Ce(t,r,n));return n}const ce=Symbol("class"),ue=Symbol("style"),ut=Symbol("is custom element"),dt=Symbol("is html");function gr(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function tt(t,e,r,n){var a=ft(t);B&&(a[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||a[e]!==(a[e]=r)&&(e==="loading"&&(t[Kt]=r),r==null?t.removeAttribute(e):typeof r!="string"&&vt(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function We(t,e,r,n,a=!1){var s=ft(t),o=s[ut],p=!s[dt];let g=B&&o;g&&fe(!1);var u=e||{},d=t.tagName==="OPTION";for(var c in e)c in r||(r[c]=null);r.class?r.class=ct(r.class):r[ce]&&(r.class=null),r[ue]&&(r.style??(r.style=null));var l=vt(t);for(const _ in r){let x=r[_];if(d&&_==="value"&&x==null){t.value=t.__value="",u[_]=x;continue}if(_==="class"){var i=t.namespaceURI==="http://www.w3.org/1999/xhtml";ge(t,i,x,n,e==null?void 0:e[ce],r[ce]),u[_]=x,u[ce]=r[ce];continue}if(_==="style"){hr(t,x,e==null?void 0:e[ue],r[ue]),u[_]=x,u[ue]=r[ue];continue}var f=u[_];if(x!==f){u[_]=x;var y=_[0]+_[1];if(y!=="$$")if(y==="on"){const k={},M="$$"+_;let A=_.slice(2);var v=ar(A);if(tr(A)&&(A=A.slice(0,-7),k.capture=!0),!v&&f){if(x!=null)continue;t.removeEventListener(A,u[M],k),u[M]=null}if(x!=null)if(v)t[`__${A}`]=x,ae([A]);else{let $=function(L){u[_].call(this,L)};u[M]=rr(A,t,$,k)}else v&&(t[`__${A}`]=void 0)}else if(_==="style")tt(t,_,x);else if(_==="autofocus")sr(t,!!x);else if(!o&&(_==="__value"||_==="value"&&x!=null))t.value=t.__value=x;else if(_==="selected"&&d)gr(t,x);else{var h=_;p||(h=nr(h));var I=h==="defaultValue"||h==="defaultChecked";if(x==null&&!o&&!I)if(s[_]=null,h==="value"||h==="checked"){let k=t;const M=e===void 0;if(h==="value"){let A=k.defaultValue;k.removeAttribute(h),k.defaultValue=A,k.value=k.__value=M?A:null}else{let A=k.defaultChecked;k.removeAttribute(h),k.defaultChecked=A,k.checked=M?A:!1}}else t.removeAttribute(_);else I||l.includes(h)&&(o||typeof x!="string")?t[h]=x:typeof x!="function"&&tt(t,h,x)}}}return g&&fe(!0),u}function ft(t){return t.__attributes??(t.__attributes={[ut]:t.nodeName.includes("-"),[dt]:t.namespaceURI===qt})}var rt=new Map;function vt(t){var e=rt.get(t.nodeName);if(e)return e;rt.set(t.nodeName,e=[]);for(var r,n=t,a=Element.prototype;a!==n;){r=Jt(n);for(var s in r)r[s].set&&e.push(s);n=Yt(n)}return e}function de(t){R(t,t.v+1)}const pr=Zt;var br=T('<section class="glass mx-auto my-5 max-w-lg min-w-sm flex-col items-start rounded-lg shadow-lg outline outline-black/5 svelte-1befgmf"><div class="p-4 text-slate-900"><h2 class="text-2xl font-semibold"> </h2> <div class="mt-1 text-sm"> </div></div> <div class="p-4 pt-0"><!></div></section>');function J(t,e){var r=br(),n=m(r),a=m(n),s=m(a,!0);w(a);var o=E(a,2),p=m(o,!0);w(o),w(n);var g=E(n,2),u=m(g);Ue(u,()=>e.children??it),w(g),w(r),N(()=>{O(s,e.title),O(p,e.description)}),S(t,r)}var wr=T("<div><!></div>");function ht(t,e){var r=wr(),n=m(r);{var a=s=>{var o=St(),p=te(o);Ue(p,()=>e.children??it),S(s,o)};K(n,s=>{e.disabled||s(a)})}w(r),N(()=>ge(r,1,`
		fira-code min-h-10 w-full content-center rounded-sm px-3.5 py-2.5 text-[0.8em] outline-[.5px] outline-slate-600/60
	${(e.disabled?"cursor-not-allowed bg-zinc-300 text-zinc-300":"bg-white text-gray-800")??""}
	`,"svelte-zgnwvn")),S(t,r)}const ne=1e6;function yr(t,e=ne){const r=performance.now(),n=[];for(let p=0;p<e;p++)n.push(t());const a=performance.now(),s=Math.round(e/((a-r)/1e3)),o={size:e.toLocaleString(),time:(a-r).toFixed(1),idsPerSecond:s.toLocaleString()};return{time:a-r,idsPerSecond:s,sampleIds:n.slice(-3),toString:()=>`Generated ${o.size} ids in ${o.time}ms (ids/second: ${o.idsPerSecond})`}}var mr=Be('<svg><path fill="currentColor" d="M320 48a48 48 0 1 0-96 0a48 48 0 1 0 96 0M125.7 175.5c9.9-9.9 23.4-15.5 37.5-15.5c1.9 0 3.8.1 5.6.3L137.6 254c-9.3 28 1.7 58.8 26.8 74.5l86.2 53.9l-25.4 88.8c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l28.7-100.4c5.9-20.6-2.6-42.6-20.7-53.9L238 299l30.9-82.4l5.1 12.3c15 35.8 49.9 59.1 88.7 59.1H384c17.7 0 32-14.3 32-32s-14.3-32-32-32h-21.3c-12.9 0-24.6-7.8-29.5-19.7l-6.3-15c-14.6-35.1-44.1-61.9-80.5-73.1l-48.7-15C186.6 97.8 175 96 163.3 96c-31 0-60.8 12.3-82.7 34.3l-23.2 23.1c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l23.1-23.1zM91.2 352H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h69.6c19 0 36.2-11.2 43.9-28.5l11.5-25.9l-9.5-6a95.4 95.4 0 0 1-37.9-44.9z"></path></svg>');function _r(t,e){const r=Pe(e,["$$slots","$$events","$$legacy"]);var n=mr();let a;N(()=>a=We(n,a,{viewBox:"0 0 448 512",width:"1.06em",height:"1.2em",...r})),S(t,n)}var xr=(t,e)=>e.onclick(),kr=T('<div class="mt-3 flex w-full flex-row items-center"><span class="flex pr-3"><button aria-label="Run performance test" title="Run performance test"><!></button></span> <!></div>');function Ae(t,e){q(e,!0);function r(u){const d=u.toFixed(2);return Math.round(ne/(u/1e3)).toLocaleString(),`Generated ${ne.toLocaleString()} ids in ${d}ms`}var n=kr(),a=m(n),s=m(a);s.__click=[xr,e];var o=m(s);const p=V(()=>e.disabled?"text-gray-300":"text-indigo-50 active:text-white");_r(o,{get class(){return b(p)}}),w(s),w(a);var g=E(a,2);ht(g,{get disabled(){return e.disabled},children:(u,d)=>{he();var c=Z();N(l=>O(c,l),[()=>typeof e.output=="number"?r(e.output):"< Run performance test"]),S(u,c)}}),w(n),N(()=>{s.disabled=e.disabled,ge(s,1,`
			group flex h-8 w-8 content-center items-center justify-center rounded-full shadow-md shadow-gray-400
			${(e.disabled?"cursor-not-allowed disabled:bg-gray-600":"cursor-pointer bg-indigo-500 transition-all hover:bg-purple-600 active:translate-y-[1px] active:bg-purple-700")??""}`)}),S(t,n),Y()}ae(["click"]);var Ir=Be('<svg><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32v144H48c-17.7 0-32 14.3-32 32s14.3 32 32 32h144v144c0 17.7 14.3 32 32 32s32-14.3 32-32V288h144c17.7 0 32-14.3 32-32s-14.3-32-32-32H256z"></path></svg>');function Ar(t,e){const r=Pe(e,["$$slots","$$events","$$legacy"]);var n=Ir();let a;N(()=>a=We(n,a,{viewBox:"0 0 448 512",width:"1.06em",height:"1.2em",...r})),S(t,n)}var Er=(t,e)=>e.onclick(),Sr=T('<div class="relative mt-3 flex w-full flex-row items-center"><span class="flex pr-3"><button aria-label="Create new XID" title="Create new XID"><!></button></span> <!></div>');function Ee(t,e){q(e,!0);var r=Sr(),n=m(r),a=m(n);a.__click=[Er,e];var s=m(a);const o=V(()=>e.disabled?"text-gray-300":"text-indigo-50 active:text-white");Ar(s,{get class(){return b(o)}}),w(a),w(n);var p=E(n,2);ht(p,{get disabled(){return e.disabled},children:(g,u)=>{he();var d=Z();N(()=>O(d,e.output||"< Generate a new XID")),S(g,d)}}),w(r),N(()=>{a.disabled=e.disabled,ge(a,1,`
				group flex h-8 w-8 content-center items-center justify-center rounded-full shadow-md shadow-gray-400
				${(e.disabled?"cursor-not-allowed disabled:bg-gray-600":"cursor-pointer bg-lime-600 transition-all hover:bg-lime-700 active:translate-y-[1px] active:bg-lime-800")??""}`)}),S(t,r),Y()}ae(["click"]);var Dr=(t,e)=>e.onclick(t),Mr=T("<button><!></button>");function Ne(t,e){q(e,!0);let r=Te(e,"disabled",3,!1),n=Te(e,"variant",3,"blue");var a=Mr();a.__click=[Dr,e];var s=m(a);Ue(s,()=>e.children),w(a),N(()=>{a.disabled=r(),ge(a,1,ct(["max-h-10 place-self-center rounded-lg border-b-[4px] px-6 py-2 text-sm font-semibold text-white transition-all",n()==="blue"&&"border-blue-600 bg-blue-500",n()==="lime"&&"border-lime-700 bg-lime-600",n()==="indigo"&&"border-indigo-600 bg-indigo-500",n()==="orange"&&"border-amber-700 bg-orange-500",!r()&&"cursor-pointer hover:brightness-110 active:translate-y-[1px] active:border-b-[4px] active:brightness-90"]))}),S(t,a),Y()}ae(["click"]);function Cr(t){return new Worker(""+new URL("../workers/index-jlGOW6tU.js",import.meta.url).href,{name:t==null?void 0:t.name})}var $r=T('<div class="flex flex-row items-center justify-end"><!></div> <!> <!>',1);function Rr(t,e){q(e,!0);let r=z(!1),n=z(void 0),a=z(void 0),s=V(()=>({disabled:b(r),variant:b(r)?"orange":"blue"})),o;function p(){b(r)||(o=new Cr,o.onmessage=g,u("init"))}function g(l){const{data:i}=l;if(typeof(i==null?void 0:i.type)=="string")switch(i.type){case"ready":R(r,!0);return;case"xid-generated":R(n,i.payload.xid,!0);return;case"batch-generated":R(a,i.payload.time,!0);return}}function u(l,i){o.postMessage({type:l,payload:i})}function d(){u("new-xid")}function c(){u("new-batch",{size:ne})}J(t,{title:"Dedicated worker (standard web workers)",description:"Generate XIDs using a dedicated web worker (one per page):",children:(l,i)=>{var f=$r(),y=te(f),v=m(y);Ne(v,Qt(()=>b(s),{onclick:()=>p(),children:(k,M)=>{he();var A=Z();N(()=>O(A,b(r)?"Worker started!":"Start dedicated worker")),S(k,A)},$$slots:{default:!0}})),w(y);var h=E(y,2);const I=V(()=>!b(r));Ee(h,{onclick:()=>d(),get disabled(){return b(I)},get output(){return b(n)}});var _=E(h,2);const x=V(()=>!b(r));Ae(_,{onclick:()=>c(),get disabled(){return b(x)},get output(){return b(a)}}),S(l,f)}}),Y()}const we="oklch(27.4% 0.006 286.033)",Tr="oklch(92.9% 0.013 255.508)",Nr="oklch(57.7% 0.245 27.325)",Lr="oklch(70.4% 0.191 22.216)",Br={cyan:"oklch(71.5% 0.143 215.221)",lime:"oklch(84.1% 0.238 128.85)",amber:"oklch(82.8% 0.189 84.429)",fuchsia:"oklch(59.1% 0.293 322.896)",teal:"oklch(60% 0.118 184.704)",green:"oklch(62.7% 0.194 149.214)",sky:"oklch(74.6% 0.16 232.661)",indigo:"oklch(51.1% 0.262 276.966)",violet:"oklch(54.1% 0.281 293.009)",pink:"oklch(59.2% 0.249 0.584)",blue:"oklch(62.3% 0.214 259.815)",orange:"oklch(75% 0.183 55.934)",emerald:"oklch(59.6% 0.145 163.225)"};function gt(t,e){return{log(...r){console.log(`%c[${e}]%c`,`background: ${we}; color: ${Br[t]}; font-weight: bold; line-height: 1rem;`,`background: ${we}; color: ${Tr}; line-height: 1rem`,...r)},error(...r){console.error(`%c[${e}]%c`,`background: ${we}; color: ${Nr}; font-weight: bold; line-height: 1rem;`,`background: ${we}; color: ${Lr}; line-height: 1rem`,...r)}}}var Pr=T('<p class="all-small-caps text-lg font-semibold text-lime-600">Worker active!</p> <!>',1),Ur=T('<p class="all-small-caps text-lg font-semibold text-sky-700">No worker registered yet</p> <!>',1),Wr=T('<div class="flex flex-row items-center justify-between"><!></div> <!> <!>',1);function Or(t,e){q(e,!0);let r=z(_e({ready:!1,worker:null,registration:null,error:null})),n=_e({xid:null,batch:null});const a="/service-worker.js",s=gt("lime","SW:Client");function o(i){function f(y,v){i&&i.postMessage({type:y,payload:v})}return{sendMessage:f}}Ie(async()=>{navigator.serviceWorker.addEventListener("message",p);try{const i=await navigator.serviceWorker.getRegistration(a);i&&g(i).then(f=>{b(r).registration=i,b(r).worker=f,b(r).ready=!0})}catch(i){b(r).error=`Error trying to fetch an existing service worker registration (${i})`}});function p(i){const{data:f}=i;if(typeof(f==null?void 0:f.type)=="string")switch(f.type){case"result:xid":n.xid=f.payload.xid;return;case"result:batch":n.batch=f.payload.time;return}}function g(i){return new Promise((f,y)=>{const v=i.installing||i.waiting||i.active;if(!v)return y(`Invalid service worker state (${v})`);v.state==="activated"?f(v):v.addEventListener("statechange",function h(){v.state==="activated"&&(f(v),v.removeEventListener("statechange",h))})})}async function u(){Math.random().toString(16).slice(2,8);const i=a;try{const f=await navigator.serviceWorker.register(i,{type:pr?"module":"classic"});if(!f)throw new Error("Unable to install service worker");g(f).then(y=>{b(r).registration=f,b(r).worker=y,b(r).ready=!0})}catch(f){b(r).error=`Error while trying to install the service worker at url ${i} (${f})`}}async function d(){b(r).registration&&await b(r).registration.unregister()&&(s.log("Worker unregistered successfully"),R(r,{ready:!1,registration:null,worker:null,error:null},!0))}function c(){o(b(r).worker).sendMessage("new-xid")}function l(){o(b(r).worker).sendMessage("new-batch",{size:ne})}J(t,{title:"Service worker",description:"Generate XIDs using a background service worker (persists after page close):",children:(i,f)=>{var y=Wr(),v=te(y),h=m(v);{var I=$=>{var L=Pr(),X=E(te(L),2);Ne(X,{variant:"lime",onclick:()=>d(),children:(se,pe)=>{he();var Q=Z("Unregister worker");S(se,Q)},$$slots:{default:!0}}),S($,L)},_=$=>{var L=Ur(),X=E(te(L),2);Ne(X,{variant:"blue",onclick:()=>u(),children:(se,pe)=>{he();var Q=Z("Register worker");S(se,Q)},$$slots:{default:!0}}),S($,L)};K(h,$=>{b(r).ready?$(I):$(_,!1)})}w(v);var x=E(v,2);const k=V(()=>!b(r).ready);Ee(x,{onclick:()=>c(),get disabled(){return b(k)},get output(){return n.xid}});var M=E(x,2);const A=V(()=>!b(r).ready);Ae(M,{onclick:()=>l(),get disabled(){return b(A)},get output(){return n.batch}}),S(i,y)}}),Y()}var xe="0123456789abcdefghijklmnopqrstuv",G=20,ke=12,P=255,Gr=65535,C=new Uint8Array(Array.from(xe).map(t=>t.charCodeAt(0))),$e=(()=>{const t=new Uint8Array(123).fill(255);for(let e=0;e<xe.length;e++)t[xe.charCodeAt(e)]=e;return t})(),Hr=new Array(G);function pt(t){const e=Hr,r=t[0],n=t[1],a=t[2],s=t[3],o=t[4],p=t[5],g=t[6],u=t[7],d=t[8],c=t[9],l=t[10],i=t[11];return e[19]=C[i<<4&31],e[18]=C[i>>1&31],e[17]=C[(i>>6|l<<2)&31],e[16]=C[l>>3&31],e[15]=C[c&31],e[14]=C[(c>>5|d<<3)&31],e[13]=C[d>>2&31],e[12]=C[(d>>7|u<<1)&31],e[11]=C[(u>>4|g<<4)&31],e[10]=C[g>>1&31],e[9]=C[(g>>6|p<<2)&31],e[8]=C[p>>3&31],e[7]=C[o&31],e[6]=C[(o>>5|s<<3)&31],e[5]=C[s>>2&31],e[4]=C[(s>>7|a<<1)&31],e[3]=C[(a>>4|n<<4)&31],e[2]=C[n>>1&31],e[1]=C[(n>>6|r<<2)&31],e[0]=C[r>>3&31],String.fromCharCode.apply(null,e)}function zr(t){if(!t||t.length!==G)throw new Error(`Invalid XID length: expected ${G}, got ${(t==null?void 0:t.length)||0}`);const e=new Uint8Array(ke),r=new Uint8Array(G);for(let n=0;n<G;n++)r[n]=t.charCodeAt(n);try{const n=new Uint8Array(G);for(let a=0;a<G;a++){const s=r[a],o=$e[s];if(o===255)throw new Error(`Invalid character '${t[a]}' at position ${a}`);n[a]=o}if(e[0]=n[0]<<3|n[1]>>2,e[1]=n[1]<<6|n[2]<<1|n[3]>>4,e[2]=n[3]<<4|n[4]>>1,e[3]=n[4]<<7|n[5]<<2|n[6]>>3,e[4]=n[6]<<5|n[7],e[5]=n[8]<<3|n[9]>>2,e[6]=n[9]<<6|n[10]<<1|n[11]>>4,e[7]=n[11]<<4|n[12]>>1,e[8]=n[12]<<7|n[13]<<2|n[14]>>3,e[9]=n[14]<<5|n[15],e[10]=n[16]<<3|n[17]>>2,e[11]=n[17]<<6|n[18]<<1|n[19]>>4,xe[e[11]<<4&31]!==t[19])throw new Error("XID consistency check failed");return e}catch(n){if(n instanceof Error&&n.message.includes("Invalid character"))throw n;if(n instanceof Error&&n.message.includes("out of range"))for(let a=0;a<G;a++){const s=r[a];if(s>=$e.length||$e[s]===255)throw new Error(`Invalid character '${t[a]}' (code ${s}) at position ${a}`)}throw new Error(`XID decoding error: ${n instanceof Error?n.message:String(n)}`)}}var Xr=class ye{constructor(e){this.bytes=e}static fromBytes(e){if(!(e instanceof Uint8Array))throw new Error("ID is not a Uint8Array");if(e.length!==ke)throw new Error("Invalid id length");return new ye(e)}static fromString(e){if(e.length!==G)throw new Error("Invalid id length");if(!/[0-9a-v]{20}/.test(e))throw new Error("Invalid string id (must be 20 chars, 0-9 a-v");return new ye(zr(e))}static nilID(){return new ye(new Uint8Array(ke))}get time(){const e=this.bytes,r=e[0]<<24|e[1]<<16|e[2]<<8|e[3];return new Date(r*1e3)}get machineId(){return this.bytes.slice(4,7)}get processId(){const e=this.bytes;return e[7]<<8|e[8]}get counter(){const e=this.bytes;return e[9]<<16|e[10]<<8|e[11]}toString(){return pt(this.bytes)}isNil(){return this.bytes.every(e=>e===0)}equals(e){return this===e?!0:this.bytes.every((r,n)=>r===e.bytes[n])}};function jr(t){let e;globalThis.SharedArrayBuffer?e=new SharedArrayBuffer(4):globalThis.WebAssembly?e=new WebAssembly.Memory({initial:1,maximum:1,shared:!0}).buffer:e=new ArrayBuffer(4);const r=new Uint32Array(e);return r[0]=t,{getNext(){const n=Atomics.add(r,0,1);return n===0&&(r[0]=t&65535),n&16777215}}}async function Fr(t,e={}){const r=await t.get("RandomBytes",e.randomBytes||null),n=await t.get("HashFunction"),s=await(await t.get("MachineId",e.machineId?async()=>e.machineId:null))(),o=(await n(s)).subarray(0,3),g=await(await t.get("ProcessId",e.processId?async()=>e.processId:null))()&65535,u=new Uint8Array(ke);u[4]=o[0]&P,u[5]=o[1]&P,u[6]=o[2]&P,u[7]=g>>8&P,u[8]=g&P;const d=r(3),c=r(3),l=r(3),i=d[0]<<16|c[1]<<8|l[2],f=jr(i);function y(v){const h=new Uint8Array(u);v=Math.floor(v/1e3),h[0]=v>>24&P,h[1]=v>>16&P,h[2]=v>>8&P,h[3]=v&P;const I=f.getNext();return h[9]=I>>16&P,h[10]=I>>8&P,h[11]=I&P,h}return{machineId:s,processId:g,newId(v){const h=v instanceof Date?+v:Date.now();return Xr.fromBytes(y(h))},fastId(){return pt(y(Date.now()))}}}var Vr={async test(t){if(typeof t!="function")return!1;try{const e=await t("custom-hash-test");return e instanceof Uint8Array&&e.length===32}catch{return!1}},async fallback(t){console.warn("Using non-secure fallback (hash)");const e=typeof t=="string"?t:t.toString();let r=2166136261;for(let a=0;a<e.length;a++)r^=e.charCodeAt(a),r=r*16777619>>>0;const n=new Uint8Array(32);for(let a=0;a<32;a++)n[a]=(r^a*83)+a&255;return n}},qr={async test(t){if(typeof t!="function")return!1;try{const e=await t();return!!e&&typeof e=="string"&&e.length>0}catch{return!1}},async fallback(){console.warn("Using non-secure fallback (machine id)");const t=Date.now().toString(36),e=()=>Math.random().toString(36).substring(2,10);return`${e()}-${t}-${e()}`}},Yr={async test(t){if(typeof t!="function")return!1;try{const e=await t();return typeof e=="number"&&e>0}catch{return!1}},async fallback(){return console.warn("Using non-secure fallback (process id)"),Math.floor(Math.random()*65535)+1}},Kr={async test(t){if(typeof t!="function")return!1;try{const e=t(5);return e instanceof Uint8Array&&e.length===5}catch{return!1}},fallback(t){console.warn("Using non-secure fallback (randomBytes)");const e=new Uint8Array(t);for(let r=0;r<t;r++)e[r]=Math.floor(Math.random()*256);return e}},Jr={RandomBytes:Kr,HashFunction:Vr,MachineId:qr,ProcessId:Yr},Zr=class{constructor(t){Ve(this,"cache",new Map);this.adapter=t}async get(t,e){const r=Jr[t];if(e&&await r.test(e))return this.cache.set(t,e),e;if(this.cache.has(t))return this.cache.get(t);const n=this.adapter[t];return await r.test(n)?(this.cache.set(t,n),n):r.fallback}},Qr=async t=>{typeof t=="string"&&(t=new TextEncoder().encode(t));const e=await globalThis.crypto.subtle.digest("SHA-256",t);return new Uint8Array(e)};async function en(){const t=[],e=(Math.random()*65535|0).toString(16).padStart(2,"0"),r=Date.now().toString(36);return t.push(`salt: ${e}:${r}`),t.push(`env:${tn()}`),ve(navigator)&&(t.push(`ua:${navigator.userAgent||""}`),t.push(`lang:${navigator.language||""}`),navigator.languages&&Array.isArray(navigator.languages)&&t.push(`langs:${navigator.languages.join(",")}`),"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency&&t.push(`cores:${navigator.hardwareConcurrency}`),"deviceMemory"in navigator&&navigator.deviceMemory&&t.push(`mem:${navigator.deviceMemory}`)),ve(screen)&&(t.push(`colorDepth:${screen.colorDepth}`),t.push(`width:${screen.width}`),t.push(`height:${screen.height}`),screen.availWidth&&t.push(`availWidth:${screen.availWidth}`),screen.availHeight&&t.push(`availHeight:${screen.availHeight}`)),t.push(`tz:${new Date().getTimezoneOffset()}`),t.filter(Boolean).join("||")}function tn(){return ve(window)&&ve(document)?"browser":ve(self)&&typeof importScripts=="function"?Re(self,ServiceWorkerGlobalScope)?"service-worker":Re(self,DedicatedWorkerGlobalScope)?"dedicated-worker":Re(self,SharedWorkerGlobalScope)?"shared-worker":"web-worker":"unknown"}function ve(t){return typeof t<"u"}function Re(t,e){return typeof e<"u"&&t instanceof e}var rn=async()=>Math.floor(Math.random()*(Gr-255+1))+255,nn=t=>{const e=new Uint8Array(t);return globalThis.crypto.getRandomValues(e)},an=new Zr({RandomBytes:nn,HashFunction:Qr,MachineId:en,ProcessId:rn});async function sn(t){return Fr(an,t)}var bt={init:sn},U,W,H,re,me;const Oe=class Oe extends Map{constructor(r){super();oe(this,re);oe(this,U,new Map);oe(this,W,j(0));oe(this,H,j(0));if(r){for(var[n,a]of r)super.set(n,a);D(this,H).v=super.size}}has(r){var n=D(this,U),a=n.get(r);if(a===void 0){var s=super.get(r);if(s!==void 0)a=j(0),n.set(r,a);else return b(D(this,W)),!1}return b(a),!0}forEach(r,n){be(this,re,me).call(this),super.forEach(r,n)}get(r){var n=D(this,U),a=n.get(r);if(a===void 0){var s=super.get(r);if(s!==void 0)a=j(0),n.set(r,a);else{b(D(this,W));return}}return b(a),super.get(r)}set(r,n){var c;var a=D(this,U),s=a.get(r),o=super.get(r),p=super.set(r,n),g=D(this,W);if(s===void 0)a.set(r,j(0)),R(D(this,H),super.size),de(g);else if(o!==n){de(s);var u=g.reactions===null?null:new Set(g.reactions),d=u===null||!((c=s.reactions)!=null&&c.every(l=>u.has(l)));d&&de(g)}return p}delete(r){var n=D(this,U),a=n.get(r),s=super.delete(r);return a!==void 0&&(n.delete(r),R(D(this,H),super.size),R(a,-1),de(D(this,W))),s}clear(){if(super.size!==0){super.clear();var r=D(this,U);R(D(this,H),0);for(var n of r.values())R(n,-1);de(D(this,W)),r.clear()}}keys(){return b(D(this,W)),super.keys()}values(){return be(this,re,me).call(this),super.values()}entries(){return be(this,re,me).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return b(D(this,H)),super.size}};U=new WeakMap,W=new WeakMap,H=new WeakMap,re=new WeakSet,me=function(){b(D(this,W));var r=D(this,U);if(D(this,H).v!==r.size)for(var n of Ye(Oe.prototype,this,"keys").call(this))r.has(n)||r.set(n,j(0));for(var[,a]of D(this,U))b(a)};let Le=Oe;var on=Be('<svg><path fill="currentColor" d="M256 512a256 256 0 1 0 0-512a256 256 0 1 0 0 512m-81-337c9.4-9.4 24.6-9.4 33.9 0l47 47l47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47l47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47l-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47l-47-47c-9.4-9.4-9.4-24.6 0-33.9"></path></svg>');function ln(t,e){const r=Pe(e,["$$slots","$$events","$$legacy"]);var n=on();let a;N(()=>a=We(n,a,{viewBox:"0 0 512 512",width:"1.2em",height:"1.2em",...r})),S(t,n)}var cn=(t,e)=>e.ondelete(e.clientId),un=T('<div class="flex basis-[50%] flex-col rounded-md border-[1px] border-stone-300 bg-stone-300/40 px-4 py-3"><div class="flex flex-row justify-between"><h2 class="text-md text-slate-700"><span class="mr-1">Client ID:</span><strong> </strong></h2> <button aria-label="Remove client" title="Remove client" class="cursor-pointer"><!></button></div> <!> <!></div>');function dn(t,e){q(e,!0);let r=Te(e,"port",7),n=z(void 0),a=z(void 0);Ie(async()=>{r().onmessage=h=>{if(!h.data||!h.data.type||!h.data.dest||h.data.dest!=="client"||typeof h.data.type!="string")return;const{type:I,payload:_}=h.data;switch(I){case"result:xid":R(n,_.xid,!0);return;case"result:batch":R(a,_.time,!0);return}}});function s(h,I){r().postMessage({dest:"worker",type:h,payload:I})}function o(){s("new-xid")}function p(){s("new-batch",{size:ne})}var g=un(),u=m(g),d=m(u),c=E(m(d)),l=m(c,!0);w(c),w(d);var i=E(d,2);i.__click=[cn,e];var f=m(i);ln(f,{class:"h-5 w-5 text-orange-600 transition-all hover:text-red-600 active:text-red-800",style:"filter: drop-shadow(0 0 10px rgba(255,255,255, .5))"}),w(i),w(u);var y=E(u,2);Ee(y,{onclick:()=>o(),get output(){return b(n)}});var v=E(y,2);Ae(v,{onclick:()=>p(),get output(){return b(a)}}),w(g),N(()=>O(l,e.clientId)),S(t,g),Y()}ae(["click"]);var fn=(t,e)=>e(),vn=T('<h2 class="self-center text-sky-700">No worker registered on this tab yet :)</h2>'),hn=T('<h2 class="all-small-caps m-0 mb-2 self-center p-0 text-xl font-bold text-sky-700">Global status</h2> <div class="flex flex-col"><div class="flex flex-row justify-between"><span>Current window ID: <strong> </strong></span> <span>Clients connected: <strong> </strong></span></div> <div class="flex flex-row justify-between"><span>Last ID generated:</span> <span>IDs generated: <strong> </strong></span></div></div> <div class="mt-1 rounded-sm bg-white p-1 font-mono text-xs text-slate-600"><!></div>',1),gn=T(`<div class="flex flex-col gap-1"><div class="mb-1 flex flex-row justify-end"><button class="
					max-h-10 cursor-pointer place-self-center rounded-lg border-b-[4px] border-blue-600 bg-blue-500 px-6 py-2 text-sm font-semibold
					text-white transition-all
					hover:border-blue-700 hover:brightness-110 active:translate-y-[1px] active:border-b-[4px] active:brightness-90">Add new client</button></div> <div class="flex min-h-14 flex-col justify-center rounded-md bg-blue-200/70 p-3 text-sm"><!></div> <div class="flex flex-col gap-2"></div></div>`);function pn(t,e){q(e,!0);const r=_e({xids:[],clients:[]}),n=_e({clients:new Le,tabID:null});let a;const s=gt("teal","shared-worker:client");Ie(async()=>{const c=await bt.init();window.location.hash||(window.location.hash=c.fastId()),n.tabID=window.location.hash.replace("#",""),a=await er(()=>import("../chunks/MGQ3vu1e.js"),[],import.meta.url)});function o(c){const{data:l}=c;if(typeof(l==null?void 0:l.type)=="string")switch(l.type){case"ready":{n.clients.set(l.payload.clientId,c.target);return}}}function p(c){if(!c.data||!c.data.type||!c.data.dest||typeof c.data.type!="string"||c.data.dest!=="broadcast")return;const{type:l,payload:i}=c.data;switch(l){case"client-added":s.log("Client added:",i),r.clients=i.clients;return;case"client-removed":s.log("Client removed:",i),r.clients=i.clients;return;case"result:xid":r.xids.push([i.xid,i.origin]);return}}const g=(()=>{let c=null;return{setup:f=>{c||(c=f,f.addEventListener("message",p))},remove:f=>{if(f===c){f.removeEventListener("message",p);const y=n.clients.values().next().value;y?(c=y,y.addEventListener("message",p)):c=null}}}})();async function u(){const c=new a.default({name:"nexid:showcase-shared-worker"});c.port.addEventListener("message",o),g.setup(c.port),c.port.start(),c.port.postMessage({type:"register",payload:{tabID:n.tabID}})}function d(c){const l=n.clients.get(c);l&&(l.postMessage({type:"unregister"}),n.clients.delete(c),r.clients=r.clients.filter(i=>i!==c),g.remove(l))}J(t,{title:"Shared workers",description:`This demo shows multiple clients communicating with the same shared worker instance. All clients
		share the same XID generator and can see each other's activity.`,children:(c,l)=>{var i=gn(),f=m(i),y=m(f);y.__click=[fn,u],w(f);var v=E(f,2),h=m(v);{var I=k=>{var M=vn();S(k,M)},_=k=>{var M=hn(),A=E(te(M),2),$=m(A),L=m($),X=E(m(L)),se=m(X,!0);w(X),w(L);var pe=E(L,2),Q=E(m(pe)),wt=m(Q,!0);w(Q),w(pe),w($);var Ge=E($,2),He=E(m(Ge),2),ze=E(m(He)),yt=m(ze,!0);w(ze),w(He),w(Ge),w(A);var Xe=E(A,2),mt=m(Xe);{var _t=ee=>{var ie=Z();const je=V(()=>r.xids.at(r.xids.length-1));N(()=>O(ie,`${b(je)[0]} (origin: ${b(je)[1]})`)),S(ee,ie)},xt=ee=>{var ie=Z();ie.nodeValue="None",S(ee,ie)};K(mt,ee=>{r.xids.length>0?ee(_t):ee(xt,!1)})}w(Xe),N(()=>{O(se,n.tabID),O(wt,r.clients.length),O(yt,r.xids.length)}),S(k,M)};K(h,k=>{r.clients.length===0?k(I):k(_,!1)})}w(v);var x=E(v,2);lr(x,21,()=>n.clients.entries(),ir,(k,M)=>{let A=()=>b(M)[0],$=()=>b(M)[1];dn(k,{get clientId(){return A()},get port(){return $()},ondelete:d})}),w(x),w(i),S(c,i)}}),Y()}ae(["click"]);var bn=T('<div class="flex flex-col"><!> <!></div>');function wn(t,e){q(e,!0);let r=z(!1),n=z(void 0),a=z(void 0);const s=1e5;let o;Ie(async()=>{o=await bt.init(),R(r,!0)});function p(){R(n,o.fastId(),!0)}function g(){const u=yr(o.fastId,s);R(a,u.time,!0)}J(t,{title:"Main thread",description:"Generate XIDs directly in the main browser thread:",children:(u,d)=>{var c=bn(),l=m(c);Ee(l,{onclick:()=>p(),get output(){return b(n)}});var i=E(l,2);Ae(i,{onclick:()=>g(),get output(){return b(a)}}),w(c),S(u,c)}}),Y()}var yn=T('<div class="flex flex-col gap-2 pt-5"><section><!></section> <section><!></section> <section><!></section> <section><!></section></div>');function Dn(t){var e=yn(),r=m(e),n=m(r);wn(n,{}),w(r);var a=E(r,2),s=m(a);{var o=v=>{Rr(v,{})},p=v=>{J(v,{title:"Oh no!",description:"Shared workers aren't supported on this browser."})};K(s,v=>{"Worker"in globalThis?v(o):v(p,!1)})}w(a);var g=E(a,2),u=m(g);{var d=v=>{Or(v,{})},c=v=>{J(v,{title:"Oh no!",description:"Service workers aren't supported on this browser."})};K(u,v=>{"ServiceWorker"in globalThis?v(d):v(c,!1)})}w(g);var l=E(g,2),i=m(l);{var f=v=>{pn(v,{})},y=v=>{J(v,{title:"Oh no!",description:"Shared workers aren't supported on this browser."})};K(i,v=>{"SharedWorker"in globalThis?v(f):v(y,!1)})}w(l),w(e),S(t,e)}export{Dn as component};
